<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="realtime.shopping.product.mapper.ProductMapper">

	<select id="getMaxProductSeq" parameterType="map" resultType="map" >
	
		/* ProductMapper.getMaxProductSeq : 판매품목 시퀀스 조회 */
		SELECT MAX(PRODUCT_SEQ)+1 productSeq  /* 상품목록일련번호 */
		FROM TB_PRODUCT
		
	</select>
	
	<select id="getMaxHashtagSeq" parameterType="map" resultType="map" >
	
		/* ProductMapper.getMaxHashtagSeq : 해시태그 시퀀스 조회 */
		SELECT MAX(HASHTAG_SEQ)+1 hashtagSeq  /* 해시태그일련번호 */
		FROM TB_HASHTAG
		
	</select>
	
	<select id="selectSellProductList" parameterType="map" resultType="map" >
		
		/* ProductMapper.selectSellProduct : 판매품목 상세조회 */
		SELECT PRODUCT_SEQ			/* 상품목록일련번호 */
		     , TITLE                /* 제목             */ 
		     , MIN_COST             /* 최소가격         */
		     , MAX_COST             /* 최대가격         */
		     , TRADE_SE			    /* 거래종류         */
		     , SALE_LOC             /* 판매위치         */
		     , SALE_COORDINATE      /* 판매좌표         */
		     , DELEGATE_FILE_ID     /* 대표파일아이디   */
		     , FILE_ID			    /* 파일아이디       */
		     , CONTENT			    /* 내용             */
		     , SALE_SE              /* 판매여부         */
		     , IN_ID                /* 등록아이디       */
		     , IN_DT                /* 등록일           */
		     , UP_ID                /* 수정아이디       */
		     , UP_DT DATE           /* 수정일           */
		     , SALE_START_DATE      /* 판매시작날짜     */
		     , SALE_END_DATE        /* 판매종료날짜     */
		     , READ_CNT             /* 읽은횟수         */
		     , INTEREST_CNT         /* 찜한횟수         */
		     , LAST_BUYER_ID        /* 최종구매자아이디 */
		FROM TB_PRODUCT
		WHERE IN_ID = #{userId}
		ORDER BY PRODUCT_SEQ DESC
	
	</select>
	
	<select id="selectSellProduct" parameterType="map" resultType="map" >
		
		/* ProductMapper.selectSellProduct : 판매품목 상세조회  */
		SELECT PRODUCT_SEQ			/* 상품목록일련번호 */
		     , TITLE                /* 제목             */ 
		     , MIN_COST             /* 최소가격         */
		     , MAX_COST             /* 최대가격         */
		     , TRADE_SE			    /* 거래종류         */
		     , SALE_LOC             /* 판매위치         */
		     , SALE_COORDINATE      /* 판매좌표         */
		     , DELEGATE_FILE_ID     /* 대표파일아이디   */
		     , FILE_ID			    /* 파일아이디       */
		     , CONTENT			    /* 내용             */
		     , SALE_SE              /* 판매여부         */
		     , IN_ID                /* 등록아이디       */
		     , IN_DT                /* 등록일           */
		     , UP_ID                /* 수정아이디       */
		     , UP_DT DATE           /* 수정일           */
		     , SALE_START_DATE      /* 판매시작날짜     */
		     , SALE_END_DATE        /* 판매종료날짜     */
		     , READ_CNT             /* 읽은횟수         */
		     , INTEREST_CNT         /* 찜한횟수         */
		     , LAST_BUYER_ID        /* 최종구매자아이디 */
		FROM TB_PRODUCT
		WHERE PRODUCT_SEQ = #{PRODUCT_SEQ}
    
	</select>
	
	<update id="updateSellReadCnt" parameterType="map">
	
		/* updateSellReadCnt : 판매품목 조회수증가 */
		UPDATE TB_PRODUCT
		SET READ_CNT
		WHERE
		WHERE PRODUCT_SEQ = #{PRODUCT_SEQ}
		
	</update>
	
	<insert id="insertSellProduct" parameterType="map">

		/* ProductMapper.insertSellProduct : 판매품목 등록 */
 		INSERT INTO
 		TB_PRODUCT
 		(
		  PRODUCT_SEQ
		, TITLE
		, MIN_COST
		, MAX_COST
		, TRADE_SE
		, SALE_LOC
		, SALE_COORDINATE
		, DELEGATE_FILE_ID
		, FILE_ID
		, CONTENT
		, SALE_SE
		, IN_ID
		, IN_DT
		, UP_ID
		, UP_DT
		, SALE_START_DATE
		, SALE_END_DATE
		, READ_CNT
		, INTEREST_CNT
		, LAST_BUYER_ID
		)
		VALUES
		(
		  #{productSeq}
		, #{title}
		, #{cash.lower}
		, #{cash.upper}
		, #{tradeSe}
		, #{saleLoc}
		, #{saleCoordinate}
		, #{delegateFileId}
		, #{fileId}
		, #{content}
		, #{saleSe}
		, #{userId}
		, NOW()
		, #{userId}
		, NOW()
		, NOW()
		, #{saleEndDate}
		, 0
		, 0
		, #{lastBuyerId}
		)
	
	</insert>
	
	<insert id="insertHashtag" parameterType="map">
		
		/* insertHashtag : 해시태그등록 */
		INSERT INTO 
		TB_HASHTAG
		(
		  HASHTAG_SEQ
		, HASHTAG
		)
		VALUES
		(
		  #{hashtagSeq}
		, #{hashtag}
		)
	
	</insert>
	
	<insert id="insertHashtagProduct" parameterType="map">
	
		/* insertHashtagProduct : 해시태그상품등록 */
		INSERT INTO 
		TB_IF_HASHTAG_PRODUCT
		(
		  HASHTAG_SEQ
		, PRODUCT_SEQ
		)
		VALUES
		(
		  #{hashtagSeq}
		, #{productSeq}
		)
	
	</insert>
	
<!-- 		insert into -->
<!--  		tb_product -->
<!--  		( -->
<!-- 		  PRODUCT_SEQ -->
<!-- 		, TITLE -->
<!-- 		, MIN_COST -->
<!-- 		, MAX_COST -->
<!-- 		, TRADE_SE -->
<!-- 		, SALE_LOC -->
<!-- 		, SALE_COORDINATE -->
<!-- 		, DELEGATE_FILE_ID -->
<!-- 		, FILE_ID -->
<!-- 		, CONTENT -->
<!-- 		, SALE_SE -->
<!-- 		, IN_ID -->
<!-- 		, IN_DT -->
<!-- 		, UP_ID -->
<!-- 		, UP_DT -->
<!-- 		, SALE_START_DATE -->
<!-- 		, SALE_END_DATE -->
<!-- 		, READ_CNT -->
<!-- 		, INTEREST_CNT -->
<!-- 		, LAST_BUYER_ID -->
<!-- 		) -->
	
<!-- 	values(  -->
<!-- 	  1 -->
<!-- 	, '테스트' -->
<!-- 	, 100000 -->
<!-- 	, 150000 -->
<!-- 	, '01' /* 직거래 */ -->
<!-- 	, '신도림역 2번출구 토스트가게 앞' -->
<!-- 	, '37.5078451,126.8911148' -->
<!-- 	, '' -->
<!-- 	, '' -->
<!-- 	, '아디다스 판매합니다.' -->
<!-- 	, '1' -->
<!-- 	, 'admin' -->
<!-- 	, NOW() -->
<!-- 	, 'admin' -->
<!-- 	, NOW() -->
<!-- 	, NOW() -->
<!-- 	, null -->
<!-- 	, null -->
<!-- 	, null -->
<!-- 	, null -->
<!-- 	); -->

</mapper>